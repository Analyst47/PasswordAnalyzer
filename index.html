<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fahim's Password Analyzer</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #f4f4f4;
  color: #333;
  margin: 0;
  padding: 0;
}

header {
  background: #fff;
  padding: 40px 20px;
  text-align: center;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

header h1 {
  font-size: 2.5em;
  margin: 0;
}

main {
  max-width: 700px;
  margin: 50px auto;
  background: #fff;
  padding: 40px 30px;
  border-radius: 8px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

label {
  font-weight: bold;
  display: block;
  margin-bottom: 10px;
  font-size: 1.1em;
}

input[type="password"], input[type="text"] {
  width: 100%;
  padding: 15px;
  font-size: 1.1em;
  margin-bottom: 20px;
  border-radius: 5px;
  border: 1px solid #ccc;
}

button {
  padding: 12px 25px;
  font-size: 1em;
  margin: 10px 5px 0 0;
  border-radius: 5px;
  border: none;
  background: #0078d4;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

button:hover {
  background: #005ea2;
}

.section {
  margin-top: 30px;
}

#strength, #entropy, #complexity, #breachPanel {
  font-size: 1.1em;
  margin-top: 15px;
  padding: 15px;
  border-radius: 5px;
}

#strength {
  background: #e7f3fe;
  color: #0078d4;
}

#entropy {
  background: #f0f0f0;
  color: #333;
}

#complexity {
  background: #f0f0f0;
  color: #333;
}

#generatedBox {
  background: #e7f3fe;
  padding: 15px;
  border-radius: 5px;
  margin-top: 20px;
}

#breachPanel {
  background: #ffe7e7;
  color: #d8000c;
  font-weight: bold;
}

a {
  color: #0078d4;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}
</style>
</head>
<body>
<header>
  <h1>Fahim's Password Analyzer</h1>
</header>

<main>
  <div class="section">
    <label for="password">Enter password to check:</label>
    <input type="password" id="password" placeholder="Enter password">
    <button id="checkBreach">Check Breach</button>
    <button id="generate">Generate Strong Password</button>
  </div>

  <div id="strength" class="section">Strength: </div>
  <div id="entropy" class="section">Entropy: </div>
  <div id="complexity" class="section">Complexity: </div>

  <div id="generatedBox" class="section" style="display:none;">
    Generated Password: <span id="generatedPw"></span>
    <br>
    <button id="copyBtn">Copy to Clipboard</button>
    <button id="toggleGenerated">Hide</button>
  </div>

  <div id="breachPanel" class="section" style="display:none;">
    Password check verified via <strong>Have I Been Pwned API</strong>.<br>
    Trusted by Microsoft, 1Password, Cloudflare.<br>
    <a href="https://haveibeenpwned.com/Passwords" target="_blank">Learn more</a>
  </div>
</main>

<script>
const passwordInput = document.getElementById('password');
const strengthDiv = document.getElementById('strength');
const entropyDiv = document.getElementById('entropy');
const complexityDiv = document.getElementById('complexity');
const breachPanel = document.getElementById('breachPanel');
const breachBtn = document.getElementById('checkBreach');

function evaluatePassword(pw){
  let score=0, charset=0, complexity='';
  if(/[a-z]/.test(pw)){score++; charset+=26; complexity+='Lowercase '; }
  if(/[A-Z]/.test(pw)){score++; charset+=26; complexity+='Uppercase '; }
  if(/[0-9]/.test(pw)){score++; charset+=10; complexity+='Numbers '; }
  if(/[^A-Za-z0-9]/.test(pw)){score+=2; charset+=32; complexity+='Symbols '; }
  if(pw.length>=8) score+=2;
  if(pw.length>=12) score+=2;
  const entropy=Math.log2(Math.pow(charset,pw.length)||1).toFixed(1);
  return {score, entropy, complexity};
}
function getStrengthLabel(score){
  if(score<=2) return 'Weak';
  if(score<=4) return 'Medium';
  if(score<=6) return 'Strong';
  return 'Very Strong';
}

passwordInput.addEventListener('input', ()=>{
  const pw=passwordInput.value;
  const {score, entropy, complexity}=evaluatePassword(pw);
  strengthDiv.textContent='Strength: '+getStrengthLabel(score);
  entropyDiv.textContent='Entropy: '+entropy+' bits';
  complexityDiv.textContent='Complexity: '+complexity;
  breachPanel.style.display='none';
});

// ------------------- Breach Check -------------------
breachBtn.addEventListener('click', async ()=>{
  const pw=passwordInput.value;
  if(!pw){ alert('Enter a password first'); return; }
  const encoder = new TextEncoder();
  const data = encoder.encode(pw);
  const hashBuffer = await crypto.subtle.digest('SHA-1', data);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  const hashHex = hashArray.map(b => b.toString(16).padStart(2,'0')).join('').toUpperCase();
  const prefix = hashHex.slice(0,5);
  const suffix = hashHex.slice(5);
  const res = await fetch(`https://api.pwnedpasswords.com/range/${prefix}`);
  const text = await res.text();
  const lines = text.split('\n');
  const match = lines.find(line => line.split(':')[0] === suffix);
  if(match){
    breachPanel.style.display='block';
    breachPanel.textContent = `⚠️ Password FOUND in ${match.split(':')[1]} breaches! Verified via Have I Been Pwned API.`;
  } else {
    breachPanel.style.display='block';
    breachPanel.textContent = `✅ Password NOT found in known breaches. Verified via Have I Been Pwned API.`;
  }
});

// ------------------- Generate Strong Password -------------------
const generateBtn = document.getElementById('generate');
const generatedBox = document.getElementById('generatedBox');
const generatedPw = document.getElementById('generatedPw');
const copyBtn = document.getElementById('copyBtn');
const toggleGenerated = document.getElementById('toggleGenerated');

generateBtn.addEventListener('click', ()=>{
  const chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>?";
  let pw='';
  for(let i=0;i<16;i++) pw+=chars.charAt(Math.floor(Math.random()*chars.length));
  generatedPw.textContent=pw;
  generatedBox.style.display='block';
  toggleGenerated.textContent='Hide';
});

copyBtn.addEventListener('click', ()=>{
  navigator.clipboard.writeText(generatedPw.textContent);
  alert('Password copied to clipboard!');
});

toggleGenerated.addEventListener('click', ()=>{
  if(generatedBox.style.display==='none'){generatedBox.style.display='block'; toggleGenerated.textContent='Hide';}
  else {generatedBox.style.display='none'; toggleGenerated.textContent='Show';}
});
</script>
</body>
</html>

